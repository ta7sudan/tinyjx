/**
 * @Version 0.2.8
 * @Author: ta7sudan
 * @Repo: https://github.com/ta7sudan/tinyjx#readme
 * @License: MIT
 */
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t(e.tinyjx={})}(this,function(e){"use strict";function o(){return(o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o])}return e}).apply(this,arguments)}var G=function(e){return"function"==typeof e},a=function(e){return/application\/json/i.test(e)},u=function(e){return/application\/x-www-form-urlencoded/i.test(e)},J=function(e){return e&&"string"==typeof e},c=function(e){return"[object Object]"===Object.prototype.toString.call(e)},d=[],l=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor,X={json:"application/json",form:"application/x-www-form-urlencoded",html:"text/html",xml:"application/xml",text:"text/plain"},n=["onloadstart","onprogress","onabort","onerror","onload","ontimeout","onloadend","onreadystatechange"],v=Date.now(),R=Date.now()+5,B=null,F=null;function p(){var e=new XMLHttpRequest;return Object.defineProperty(e,"_active",{value:!1,writable:!0,enumerable:!1}),e}function $(t){t._active=!1;try{t.timeout=0,t.requestURL=""}catch(e){}n.forEach(function(e){return t[e]=null}),t.upload&&n.forEach(function(e){return t.upload[e]=null})}function K(){for(var e=0,t=d.length;e<t;++e)if(!d[e]._active)return d[e];return p()}function Q(e){var r,t=e.data,o=e.method,n=e.contentType,s=void 0===n?X.json:n,i=e.url;if(e.cache||(i+=~i.indexOf("?")?"&_="+ ++R:"?_="+ ++R),"GET"===o||"HEAD"===o)return{url:i,data:t};if(t instanceof Document||t instanceof Blob||t instanceof FormData||t instanceof ArrayBuffer||t instanceof l||"string"==typeof t)return{url:i,data:t};if(a(s))t=JSON.stringify(t);else{if(!u(s))throw new TypeError("Unknown data type, you can provide a custom serialize function in options to override the default.");t=c(r=t)?Object.keys(r).map(function(t){return Array.isArray(r[t])?r[t].map(function(e){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&"):encodeURIComponent(t)+"="+encodeURIComponent(r[t])}).join("&"):JSON.stringify(r)}return{url:i,data:t}}function V(e){var t=e.data,r=e.contentType,o=e.acceptType,n=null;if(J(t)&&(a(r)||a(o)))try{n=JSON.parse(t)}catch(e){console.error("Invalid json string"),n=t}else n=t;return n}function W(t,r){c(r)&&Object.keys(r).forEach(function(e){return t.setRequestHeader(e,r[e])})}function L(e){var t=e.xhr,r=e.reqData,o=e.acceptType,n=e.dslz,s=e.success,i=e.error,a=e.complete;try{var u=G(i),c=G(a),d=G(s),l=!1,p=null;t.onreadystatechange=function(e){if(4===this.readyState&&!(200<=this.status&&this.status<300||304==this.status)&&0!==this.status){if(l=!0,!u&&!c)throw new Error("Remote server error. Request URL: "+this.requestURL+", Status code: "+this.status+", message: "+this.statusText+", response: "+this.responseText+".");u&&i(new Error("Remote server error. Request URL: "+this.requestURL+", Status code: "+this.status+", message: "+this.statusText+"."),this,e),c&&a(this,"error")}};try{t.send(r||null)}catch(e){if(l=!0,!u&&!c)throw e;u&&i(e,t,null),c&&a(t,"error")}if(!l){var f=t.getResponseHeader("Content-Type");p=n({data:Z(t,"responseXML")||Z(t,"response")||Z(t,"responseText"),contentType:f,acceptType:o}),d&&s(p,t,null),c&&a(t,"success")}return $(t),p}catch(e){throw $(t),e}}function Y(t,r){c(r)&&t&&Object.keys(r).filter(function(e){return-1!==n.indexOf(e)}).forEach(function(e){return t[e]=r[e]})}function Z(e,t){try{return e[t]}catch(e){return null}}function s(t){var e=t.url,r=void 0===e?location.href:e,o=t.method,n=void 0===o?"GET":o,s=t.contentType,i=t.beforeSend,a=t.complete,u=t.data,c=t.dataType,d=void 0===c?"json":c,l=t.error,p=t.headers,f=t.mimeType,h=t.responseType,m=void 0===h?"":h,y=t.username,w=t.password,T=t.success,v=t.timeout,R=void 0===v?0:v,E=t.ontimeout,b=t.events,x=t.uploadEvents,O=t.withCredentials,g=void 0!==O&&O,j=t.cache,U=void 0===j||j,q=t.serialize,L=t.deserialize;if(n=n.toUpperCase().trim(),-1===["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"].indexOf(n))throw new Error("Invalid HTTP method: "+n);if(J(s))X[s]&&(s=X[s]);else if(s)throw new TypeError('contentType could be "json", "form", "html", "xml", "text" or other custom string.');var C,S=G(q)?q:G(B)?B:Q,H=G(L)?L:G(F)?F:V,P=/^([\w-]+:)\/\//.exec(r)[1],A=K(),D=G(a),I=G(l),k=G(T),z=!1,_=!1,N=S({data:u,method:n,contentType:s,url:r,cache:U});if(r=N.url,C=N.data,A._active=!0,A.open(n,r,!0,y,w),!A.requestURL&&(A.requestURL=r),s?A.setRequestHeader("Content-Type",s):J(C)&&A.setRequestHeader("Content-Type",X.json),J(d)&&(X[d]&&(d=X[d]),A.setRequestHeader("Accept",d)),W(A,p),J(f)&&A.overrideMimeType(f),Y(A,b),Y(A.upload,x),g&&(A.withCredentials=g),m&&(A.responseType=m),R&&(A.timeout=R),G(E)?A.ontimeout=function(e){E(e),D&&a(this,"timeout")}:R&&!G(A.ontimeout)&&(A.ontimeout=function(){if(!D)throw new Error("Request "+this.requestURL+" timeout.");a(this,"timeout")}),G(A.onloadend)){var M=A.onloadend;A.onloadend=function(e){$(this),M.call(this,e)}}else A.onloadend=function(){$(this)};return A.onreadystatechange=function(e){if(4===this.readyState)if(200<=this.status&&this.status<300||304==this.status||0==this.status&&"file:"==P){var t=this.getResponseHeader("Content-Type"),r=H({data:Z(A,"responseXML")||Z(A,"response")||Z(A,"responseText"),contentType:t,acceptType:d});k&&T(r,this,e),D&&a(this,"success")}else if(0!==this.status){if(!I&&!D)throw new Error("Remote server error. Request URL: "+this.requestURL+", Status code: "+this.status+", message: "+this.statusText+", response: "+this.responseText+".");I&&(z=!0,l(new Error("Remote server error. Request URL: "+this.requestURL+", Status code: "+this.status+", message: "+this.statusText+", response: "+this.responseText+"."),this,e)),D&&(_=!0,a(this,"error"))}},A.onerror=function(e){if(!I&&!D)throw new Error("An error occurred, maybe crossorigin error. Request URL: "+this.requestURL+", Status code: "+this.status+".");!z&&I&&l(new Error("Network error or browser restricted. Request URL: "+this.requestURL+", Status code: "+this.status),this,e),!_&&D&&a(this,"error")},G(i)?setTimeout(function(){var e;try{e=i(A,t)}catch(e){throw $(A),e}!1!==e?A.send(C||null):$(A)}):A.send(C||null),{abort:function(){A.abort()}}}e.config=function(e){var t=void 0===e?{}:e,r=t.pool,o=void 0!==r&&r,n=t.serialize,s=t.deserialize;if(o){var i="number"==typeof o?o:5;if(i<(d.length=0))throw new Error("pool size must >= 0");for(;i--;)d.push(p())}G(n)&&(B=n),G(s)&&(F=s)},e.ajax=s,e.ajaxSync=function(e){var t=e.url,r=void 0===t?location.href:t,o=e.method,n=void 0===o?"GET":o,s=e.contentType,i=e.beforeSend,a=e.complete,u=e.data,c=e.dataType,d=void 0===c?"json":c,l=e.error,p=e.headers,f=e.mimeType,h=e.username,m=e.password,y=e.success,w=e.events,T=e.uploadEvents,v=e.cache,R=void 0===v||v,E=e.serialize,b=e.deserialize;if(n=n.toUpperCase().trim(),-1===["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"].indexOf(n))throw new Error("Invalid HTTP method: "+n);if(J(s))X[s]&&(s=X[s]);else if(s)throw new TypeError('contentType could be "json", "form", "html", "xml", "text" or other custom string.');var x,O,g=G(E)?E:G(B)?B:Q,j=G(b)?b:G(F)?F:V,U=K(),q=g({data:u,method:n,contentType:s,url:r,cache:R});if(r=q.url,x=q.data,U._active=!0,U.open(n,r,!1,h,m),!U.requestURL&&(U.requestURL=r),s?U.setRequestHeader("Content-Type",s):J(x)&&U.setRequestHeader("Content-Type",X.json),J(d)&&(X[d]&&(d=X[d]),U.setRequestHeader("Accept",d)),W(U,p),J(f)&&U.overrideMimeType(f),Y(U,w),Y(U.upload,T),!G(i))return L({xhr:U,reqData:x,acceptType:d,dslz:j,success:y,error:l,complete:a});try{O=i(U,e)}catch(e){throw $(U),e}if(!1!==O)return L({xhr:U,reqData:x,acceptType:d,dslz:j,success:y,error:l,complete:a});$(U)},e.jsonp=function(e){var t=e.url,r=e.cache,o=void 0!==r&&r,n=e.crossorigin,s=e.callbackName,i=e.success,a=e.beforeSend,u=e.complete,c=e.error,d=G(window[s]);if(J(s)&&!d)throw new Error(s+" is not a function.");var l=G(i),p=G(c),f=G(u),h=d?window[s]:void 0;if(!l&&!f&!d)throw new Error("Must set a success callback or complete callback.");if(!J(t))throw new TypeError("url expected a non empty string, but received "+JSON.stringify(t)+".");var m=J(s),y=m?s:"jsonp"+ ++v,w=document.createElement("script");if(t.split("?").length<3){var T="callback="+encodeURIComponent(y);t=~t.indexOf("?")?t+"&"+T:t+"?"+T}else t=t.replace(/\?(.+)=\?/,"?$1="+encodeURIComponent(y));!o&&(t+="&_="+ ++R),window[y]&&window[y].hasHook||(window[y]=function(){m||delete window[y];try{d?h.apply(void 0,arguments):l&&i.apply(void 0,arguments),f&&u("success"),d&&(window[s]=h)}catch(e){throw d&&(window[s]=h),e}},window[y].hasHook=!0),w.onerror=function(e){if(document.body.removeChild(w),m||delete window[y],!p&&!f)throw new Error("Load script "+t+" failed.");p&&c(new Error("Load script "+t+" failed."),e),f&&u("error")},w.onload=function(){return setTimeout(function(){return document.body.removeChild(w)},3e3)},n&&(w.crossOrigin=n),w.src=t,G(a)?setTimeout(function(){!1!==a(t,e)&&document.body.appendChild(w)}):document.body.appendChild(w)},e.get=function(e,t){return s(o({},t,{url:e,method:"GET"}))},e.head=function(e,t){return s(o({},t,{url:e,method:"HEAD"}))},e.post=function(e,t,r){return s(o({},r,{url:e,data:t,method:"POST"}))},e.put=function(e,t,r){return s(o({},r,{url:e,data:t,method:"PUT"}))},e.del=function(e,t,r){return s(o({},r,{url:e,data:t,method:"DELETE"}))},e.patch=function(e,t,r){return s(o({},r,{url:e,data:t,method:"PATCH"}))},e.options=function(e,t,r){return s(o({},r,{url:e,data:t,method:"OPTIONS"}))},Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=tinyjx.min.js.map
