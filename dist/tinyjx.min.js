/**
 * @Version 0.3.11
 * @Author: ta7sudan
 * @Repo: https://github.com/ta7sudan/tinyjx#readme
 * @License: MIT
 */(function(a,b){"object"==typeof exports&&"undefined"!=typeof module?b(exports):"function"==typeof define&&define.amd?define(["exports"],b):b(a.tinyjx={})})(this,function(a){"use strict";function b(){return b=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},b.apply(this,arguments)}function c(){const a=new XMLHttpRequest;return Object.defineProperty(a,"_active",{value:!1,writable:!0,enumerable:!1}),a}function d(a){a._active=!1;try{a.timeout=0,a.requestURL=""}catch(a){}D.forEach(b=>a[b]=null),a.upload&&D.forEach(b=>a.upload[b]=null)}function e(){for(let a=0,b=A.length;a<b;++a)if(!A[a]._active)return A[a];return c()}function f(a){return y(a)?Object.keys(a).map(b=>Array.isArray(a[b])?a[b].map(a=>`${encodeURIComponent(b)}=${encodeURIComponent(a)}`).join("&"):`${encodeURIComponent(b)}=${encodeURIComponent(a[b])}`).join("&"):JSON.stringify(a)}function g({data:a,method:b,contentType:e=C.json,url:c,cache:d}){if(d||(c+=~c.indexOf("?")?`&_=${++F}`:`?_=${++F}`),"GET"===b||"HEAD"===b)return{url:c,data:a};if(a instanceof Document||a instanceof Blob||a instanceof FormData||a instanceof ArrayBuffer||a instanceof B||"string"==typeof a)return{url:c,data:a};if(v(e))a=JSON.stringify(a);else if(w(e))a=f(a);else throw new TypeError("Unknown data type, you can provide a custom serialize function in options to override the default.");return{url:c,data:a}}function h({data:a,contentType:b,acceptType:c}){let d=null;if(x(a)&&(v(b)||v(c)))try{d=JSON.parse(a)}catch(b){console.error("Invalid json string"),d=a}else d=a;return d}function i(a,b){y(b)&&Object.keys(b).forEach(c=>a.setRequestHeader(c,b[c]))}function j(a,b){y(b)&&a&&Object.keys(b).filter(a=>-1!==D.indexOf(a)).forEach(c=>a[c]=b[c])}function k(a){let{url:b,cache:i=!1,crossorigin:c,callbackName:d,success:e,beforeSend:f,complete:g,error:h}=a;const j=u(window[d]);if(x(d)&&!j)throw new Error(`${d} is not a function.`);const k=u(e),l=u(h),m=u(g),n=j?window[d]:void 0;if(!k&&!m&!j)throw new Error("Must set a success callback or complete callback.");if(!x(b))throw new TypeError(`url expected a non empty string, but received ${JSON.stringify(b)}.`);const o=x(d),p=o?d:`jsonp${++E}`,q=document.createElement("script");if(3>b.split("?").length){const a=`callback=${encodeURIComponent(p)}`;b=~b.indexOf("?")?`${b}&${a}`:`${b}?${a}`}else b=b.replace(/\?(.+)=\?/,`?$1=${encodeURIComponent(p)}`);i||(b+=`&_=${++F}`),window[p]&&window[p].hasHook||(window[p]=function(...a){o||delete window[p];try{j?n(...a):k&&e(...a),m&&g("success"),j&&(window[d]=n)}catch(a){throw j&&(window[d]=n),a}},window[p].hasHook=!0),q.onerror=function(a){if(document.body.removeChild(q),o||delete window[p],!l&&!m)throw new Error(`Load script ${b} failed.`);l&&h(new Error(`Load script ${b} failed.`),a),m&&g("error")},q.onload=()=>setTimeout(()=>document.body.removeChild(q),3e3),c&&(q.crossOrigin=c),q.src=b,u(f)?setTimeout(()=>{const c=f(b,a);!1!==c&&document.body.appendChild(q)}):document.body.appendChild(q)}function l(a,b){try{return a[b]}catch(a){return null}}function m(a){let{url:A=z.href,method:B="GET",contentType:b,beforeSend:c,complete:f,data:k,dataType:D="json",error:m,headers:n,mimeType:o,responseType:E="",username:p,password:q,success:r,timeout:F=0,ontimeout:s,events:t,uploadEvents:v,withCredentials:I=!1,cache:J=!0,serialize:w,deserialize:y}=a;if(B=B.toUpperCase().trim(),-1===["GET","POST","PUT","PATCH","DELETE","HEAD","OPTIONS"].indexOf(B))throw new Error(`Invalid HTTP method: ${B}`);if(x(b))C[b]&&(b=C[b]);else if(b)throw new TypeError("contentType could be \"json\", \"form\", \"html\", \"xml\", \"text\" or other custom string.");const K=u(w)?w:u(G)?G:g,L=u(y)?y:u(H)?H:h,M=/^([\w-]+:)\/\//.exec(A),N=M?M[1]:/^(https?):\/\//.exec(z.href)[1],O=e(),P=u(f),Q=u(m),R=u(r);let S,T=!1,U=!1;if(({url:A,data:S}=K({data:k,method:B,contentType:b,url:A,cache:J})),O._active=!0,O.open(B,A,!0,p,q),O.requestURL||(O.requestURL=A),b?O.setRequestHeader("Content-Type",b):x(S)&&O.setRequestHeader("Content-Type",C.json),x(D)&&(C[D]&&(D=C[D]),O.setRequestHeader("Accept",D)),i(O,n),x(o)&&O.overrideMimeType(o),j(O,t),j(O.upload,v),I&&(O.withCredentials=I),E&&(O.responseType=E),F&&(O.timeout=F),u(s)?O.ontimeout=function(a){s(a),P&&f(this,"timeout")}:F&&!u(O.ontimeout)&&(O.ontimeout=function(){if(P)f(this,"timeout");else throw new Error(`Request ${this.requestURL} timeout.`)}),u(O.onloadend)){const a=O.onloadend;O.onloadend=function(b){d(this),a.call(this,b)}}else O.onloadend=function(){d(this)};return O.onreadystatechange=function(a){if(4===this.readyState)if(200<=this.status&&300>this.status||304==this.status||0==this.status&&"file:"==N){const b=this.getResponseHeader("Content-Type"),c=L({data:l(O,"responseXML")||l(O,"response")||l(O,"responseText"),contentType:b,acceptType:D});R&&r(c,this,a),P&&f(this,"success")}else if(0!==this.status){if(!Q&&!P)throw new Error(`Remote server error. Request URL: ${this.requestURL}, Status code: ${this.status}, message: ${this.statusText}, response: ${this.responseText}.`);Q&&(T=!0,m(new Error(`Remote server error. Request URL: ${this.requestURL}, Status code: ${this.status}, message: ${this.statusText}, response: ${this.responseText}.`),this,a)),P&&(U=!0,f(this,"error"))}},O.onerror=function(a){if(!Q&&!P)throw new Error(`An error occurred, maybe crossorigin error. Request URL: ${this.requestURL}, Status code: ${this.status}.`);!T&&Q&&m(new Error(`Network error or browser restricted. Request URL: ${this.requestURL}, Status code: ${this.status}`),this,a),!U&&P&&f(this,"error")},u(c)?setTimeout(()=>{let b;try{b=c(O,a)}catch(a){throw d(O),a}!1===b?d(O):O.send(S||null)}):O.send(S||null),{abort(){O.abort()}}}function n(a,c){return m(b({},c,{url:a,method:"GET"}))}function o(a,c){return m(b({},c,{url:a,method:"HEAD"}))}function p(a,c,d){return m(b({},d,{url:a,data:c,method:"POST"}))}function q(a,c,d){return m(b({},d,{url:a,data:c,method:"PUT"}))}function r(a,c,d){return m(b({},d,{url:a,data:c,method:"DELETE"}))}function s(a,c,d){return m(b({},d,{url:a,data:c,method:"PATCH"}))}function t(a,c,d){return m(b({},d,{url:a,data:c,method:"OPTIONS"}))}const u=a=>"function"==typeof a,v=a=>/application\/json/i.test(a),w=a=>/application\/x-www-form-urlencoded/i.test(a),x=a=>a&&"string"==typeof a,y=a=>"[object Object]"===Object.prototype.toString.call(a),z=window.location,A=[],B=Object.getPrototypeOf(Object.getPrototypeOf(new Uint8Array)).constructor,C={json:"application/json",form:"application/x-www-form-urlencoded",html:"text/html",xml:"application/xml",text:"text/plain"},D=["onloadstart","onprogress","onabort","onerror","onload","ontimeout","onloadend","onreadystatechange"];let E=Date.now(),F=Date.now()+5,G=null,H=null;a.config=function({pool:d=!1,serialize:a,deserialize:b}={}){if(d){A.length=0;let a="number"==typeof d?d:5;if(0>a)throw new Error("pool size must >= 0");for(;a--;)A.push(c())}u(a)&&(G=a),u(b)&&(H=b)},a.ajax=m,a.jsonp=k,a.get=n,a.head=o,a.post=p,a.put=q,a.del=r,a.patch=s,a.options=t,Object.defineProperty(a,"__esModule",{value:!0})});
//# sourceMappingURL=tinyjx.min.js.map
